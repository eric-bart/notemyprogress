define ("local_fliplearning/grades",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/moment","local_fliplearning/pagination","local_fliplearning/chartdynamic","local_fliplearning/pageheader","local_fliplearning/emailform","local_fliplearning/helpdialog"],function(a,b,c,d,e,f,g,h,i){"use strict";return{init:function(c){a.use(b);a.component("pagination",e);a.component("chart",f);a.component("pageheader",g);a.component("emailform",h);a.component("helpdialog",i);var d=new a({delimiters:["[[","]]"],el:"#grades",vuetify:new b,data:function data(){return{strings:c.strings,groups:c.groups,userid:c.userid,courseid:c.courseid,timezone:c.timezone,render_has:c.profile_render,loading:!1,errors:[],pages:c.pages,grades:c.grades,grade_items_average_colors:c.grade_items_average_colors,item_grades_details_colors:c.item_grades_details_colors,item_grades_distribution_colors:c.item_grades_distribution_colors,default_category:null,average_categories:[],average_data:[],selected_items:[],item_details:[],grade_item_title:"",grade_item_details_categories:[],grade_item_details_data:[],grade_item_distribution_categories:[],grade_item_distribution_data:[],selected_item:null,grade_item_users:null,selected_users:[],dialog:!1,modulename:"",moduleid:!1,email_strings:c.strings.email_strings,help_dialog:!1,help_contents:[]}},beforeMount:function beforeMount(){if(this.grades.categories.length){this.default_category=this.grades.categories[0];this.calculate_chart_items_average(this.default_category.items);var a=this.find_first_grade_item(this.default_category.items);this.update_detail_charts(a)}},mounted:function mounted(){document.querySelector("#sessions-loader").style.display="none";document.querySelector("#grades").style.display="block"},methods:{get_help_content:function get_help_content(){var a=[{title:this.strings.section_help_title,description:this.strings.section_help_description}];return a},change_category:function change_category(a){this.calculate_chart_items_average(a);var b=this.find_first_grade_item(a);this.update_detail_charts(b)},build_grade_items_average_chart:function build_grade_items_average_chart(){var a={};a.chart={type:"column",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.grade_items_average_colors;a.xAxis={categories:this.average_categories};a.legend={enabled:!1};a.plotOptions={series:{cursor:"pointer",point:{events:{click:function click(){var a=this.x,b=d.selected_items[a];d.update_detail_charts(b)}}}}};a.tooltip={shared:!0,formatter:function formatter(){var a=this.points[0].point.x,b=this.y,c=d.selected_items[a],e=c.gradecount,f=this.x,g=d.strings.view_details,h=+c.average,i=d.strings.grades_tooltip_students;if(1==e){i=d.strings.grades_tooltip_student}b=d.isInt(b)?b:b.toFixed(2);h=d.isInt(h)?h:h.toFixed(2);var j=c.grademax,k="<b>"+f+"<b> <br/>"+d.strings.grades_tooltip_average+": "+h+" ("+b+" %)<br/>"+d.strings.grades_tooltip_grade+": "+j+"<br/>"+e+" "+i+" "+d.grades.student_count+"<br/><i>"+g+"</i>";return k}};a.yAxis=[{allowDecimals:!1,max:100,labels:{format:"{value} %"},title:{text:this.strings.grades_yaxis_title}}];a.series=[{data:this.average_data}];return a},build_item_grades_details_chart:function build_item_grades_details_chart(){var a={};a.chart={type:"bar",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.item_grades_details_colors;a.xAxis={type:"category"};a.legend={enabled:!1};a.tooltip={shared:!0,formatter:function formatter(){var a=this.points[0].key,b=d.selected_item.itemname,c=d.selected_item.grademax,e=this.y;e=d.isInt(e)?e:e.toFixed(2);var f="<b>"+b+"<b> <br/>"+a+": "+e+"/"+c+"<br/>";return f}};a.yAxis=[{title:{enabled:!1}}];a.series=[{colorByPoint:!0,data:this.grade_item_details_data}];return a},build_item_grades_distribution_chart:function build_item_grades_distribution_chart(){var a={};a.chart={backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.item_grades_distribution_colors;a.xAxis={categories:this.grade_item_distribution_categories};a.yAxis=[{title:{text:this.strings.grades_distribution_yaxis_title},allowDecimals:!1}];a.legend={enabled:!1};a.tooltip={formatter:function formatter(){var a=d.strings.grades_distribution_tooltip_prefix,b=d.strings.grades_distribution_tooltip_suffix,c=d.strings.send_mail,e=this.x,f=this.y,g=d.strings.students_text;if(1==f){g=d.strings.student_text}var h="<b>"+a+": </b> "+e+" <br/>"+f+" "+g+" "+b+" <br/><i>"+c+"</i>";return h}};a.plotOptions={series:{stacking:"normal",borderWidth:1,pointPadding:0,groupPadding:0},column:{point:{events:{click:function click(){var a=this.x;d.selected_users=d.grade_item_users[a];d.email_strings.subject=d.email_strings.subject_prefix+" - "+d.selected_item.itemname;d.dialog=!0}}}}};a.series=[{type:"column",data:this.grade_item_distribution_data},{type:"spline",data:this.grade_item_distribution_data,marker:{lineWidth:1}}];return a},calculate_chart_items_average:function calculate_chart_items_average(a){var b=[],c=[];a.forEach(function(a){b.push(a.average_percentage);c.push(a.itemname)});this.average_categories=c;this.average_data=b;this.selected_items=a},update_detail_charts:function update_detail_charts(a){this.modulename=a.itemmodule;this.moduleid=a.coursemoduleid;this.grade_item_title=a.itemname;this.calculate_chart_item_grade_detail(a);this.calculate_chart_item_grades_distribution(a)},calculate_chart_item_grade_detail:function calculate_chart_item_grade_detail(a){this.selected_item=a;var b=[{name:this.strings.grades_best_grade,y:+a.maxrating||0},{name:this.strings.grades_average_grade,y:+a.average||0},{name:this.strings.grades_worst_grade,y:+a.minrating||0}];this.grade_item_details_data=b},calculate_chart_item_grades_distribution:function calculate_chart_item_grades_distribution(a){var b=this,c=this.strings.grades_greater_than,d=this.strings.grades_smaller_than,e=["".concat(c," 90%"),"".concat(c," 80%"),"".concat(c," 70%"),"".concat(c," 60%"),"".concat(c," 50%"),"".concat(d," 50%")],f=[0,0,0,0,0,0],g=[[],[],[],[],[],[]];if(a){var h=[],i=a.grademax,j=i;[.9,.8,.7,.6,.5,0].forEach(function(a){var b=i*a;h.push({max:j,min:b,count:0});j=b-.1});a.grades.forEach(function(a){h.forEach(function(b,c){if(a.rawgrade>=b.min&&a.rawgrade<=b.max){b.count++;g[c].push(a.user)}})});f=[];h.forEach(function(a,c){var d=b.isInt(a.max)?a.max:a.max.toFixed(1),g=b.isInt(a.min)?a.min:a.min.toFixed(1),h="".concat(d," - ").concat(g,"<br/>").concat(e[c]);e[c]=h;f.push(a.count)})}this.grade_item_users=g;this.grade_item_distribution_categories=e,this.grade_item_distribution_data=f},find_first_grade_item:function find_first_grade_item(a){var b;if(a.length){for(var c=a.length,d=0;d<c;d++){if(0<a[d].maxrating){b=a[d];break}}if(!b){b=a[0]}}return b},isInt:function isInt(a){return 0==a%1},update_dialog:function update_dialog(a){this.dialog=a},open_chart_help:function open_chart_help(a){var b=[];if("grade_items_average"==a){b.push({title:this.strings.grade_items_average_help_title,description:this.strings.grade_items_average_help_description_p1});b.push({description:this.strings.grade_items_average_help_description_p2});b.push({description:this.strings.grade_items_average_help_description_p3})}else if("item_grades_details"==a){b.push({title:this.strings.item_grades_details_help_title,description:this.strings.item_grades_details_help_description_p1});b.push({description:this.strings.item_grades_details_help_description_p2})}else if("item_grades_distribution"==a){b.push({title:this.strings.item_grades_distribution_help_title,description:this.strings.item_grades_distribution_help_description_p1});b.push({description:this.strings.item_grades_distribution_help_description_p2});b.push({description:this.strings.item_grades_distribution_help_description_p3})}this.help_contents=b;if(this.help_contents.length){this.help_dialog=!0}},update_help_dialog:function update_help_dialog(a){this.help_dialog=a},get_timezone:function get_timezone(){var a="".concat(this.strings.ss_change_timezone," ").concat(this.timezone);return a}}})}}});
//# sourceMappingURL=grades.min.js.map

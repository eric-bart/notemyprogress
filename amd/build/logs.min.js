define(["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/moment","local_fliplearning/pagination","local_fliplearning/pageheader","local_fliplearning/helpdialog"],function(e,o,t,l,n,d,i){"use strict";return{init:function(l){t.defaults.timeout=72e5,console.log(l),e.use(o),e.component("pagination",n),e.component("pageheader",d),e.component("helpdialog",i),new e({delimiters:["[[","]]"],el:"#logs",vuetify:new o,data(){return{strings:l.strings,groups:l.groups,userid:l.userid,courseid:l.courseid,timezone:l.timezone,render_has:l.profile_render,loading:!1,errors:[],pages:l.pages,help_dialog:!1,help_contents:[],dateRules:[e=>!!e||this.strings.logs_invalid_date]}},beforeMount(){document.querySelector("#downloadButtonMoodle").style.display="none",document.querySelector("#downloadButtonNMP").style.display="none"},mounted(){document.querySelector(".v-application--wrap").style.minHeight="60vh",document.querySelector("#sessions-loader").style.display="none",document.querySelector("#logs").style.display="block",document.querySelector("#helpMoodle").style.display="block",document.querySelector("#helpNMP").style.display="block",document.querySelector("#downloadButtonMoodle").style.display="block",document.querySelector("#downloadButtonNMP").style.display="block",document.querySelector("#logsSetpointMoodle").style.display="block",document.querySelector("#logsSetpointNMP").style.display="block"},methods:{get_Moodlefile(){let e=document.querySelector("#lastDateMoodle"),o=document.querySelector("#beginDateMoodle");this.url=!1,this.loading=!0;var l={action:"downloadMOODLElogs",courseid:this.courseid,userid:this.userid,beginDate:o.value,lastDate:e.value,currentUrl:window.location.href};""!=o.value&&""!=e.value&&(document.querySelector("#downloadButtonMoodle").innerHTML=this.strings.logs_download_btn,document.getElementById("downloadButtonMoodle").disabled=!0,t({method:"get",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",timeout:72e5,params:l}).then(t=>{if(this.loading=!1,console.log("ATTENTION..."),console.log(t),200==t.status&&t.data.ok)if(""!=o.value||""!=e.value){console.log("good");let n=M.cfg.wwwroot+"/local/fliplearning/downloads/"+t.data.data.filename;console.log(t.data.data.filename),this.url=n;var l=document.createElement("a");l.href=this.url,l.download="MoodleLogs_"+o.value+"_"+e.value+".csv",l.click(),document.querySelector("#downloadButtonMoodle").innerHTML=this.strings.logs_valid_Moodlebtn,document.getElementById("downloadButtonMoodle").disabled=!1}else console.log("Problème données"),document.querySelector("#downloadButtonMoodle").innerHTML=this.strings.logs_valid_Moodlebtn,document.getElementById("downloadButtonMoodle").disabled=!1}).catch(e=>{this.loading=!1}))},get_NMPfile(){let e=document.querySelector("#lastDateNMP"),o=document.querySelector("#beginDateNMP");this.url=!1,this.loading=!0;var l={action:"downloadNMPlogs",courseid:this.courseid,userid:this.userid,beginDate:o.value,lastDate:e.value,currentUrl:window.location.href};""!=o.value&&""!=e.value&&(document.querySelector("#downloadButtonNMP").innerHTML=this.strings.logs_download_btn,document.getElementById("downloadButtonNMP").disabled=!0,t({method:"get",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",timeout:72e5,params:l}).then(t=>{if(this.loading=!1,console.log("ATTENTION..."),console.log(t),200==t.status&&t.data.ok)if(""!=o.value||""!=e.value){console.log("good");let n=M.cfg.wwwroot+"/local/fliplearning/downloads/"+t.data.data.filename;console.log(t.data.data.filename),this.url=n;var l=document.createElement("a");l.href=this.url,l.download="NMPLogs_"+o.value+"_"+e.value+".csv",l.click(),document.querySelector("#downloadButtonNMP").innerHTML=this.strings.logs_valid_NMPbtn,document.getElementById("downloadButtonNMP").disabled=!1}else console.log("Problème données"),document.querySelector("#downloadButtonNMP").innerHTML=this.strings.logs_valid_NMPbtn,document.getElementById("downloadButtonNMP").disabled=!1}).catch(e=>{this.loading=!1}))},is_today(e){var o=new Date,t=String(o.getDate()).padStart(2,"0"),l=String(o.getMonth()+1).padStart(2,"0"),n=o.getFullYear();return o=n+"-"+l+"-"+t,(e=new Date(e))>=o},get_help_content(){var e=[],o=new Object;return o.title=this.strings.title,o.description=this.strings.description,e.push(o),e},open_chart_help(e){let o=[];"download_moodle"==e?o.push({title:this.strings.logs_download_moodle_help_title,description:this.strings.logs_download_moodle_help_description}):"download_nmp"==e&&o.push({title:this.strings.logs_download_nmp_help_title,description:this.strings.logs_download_nmp_help_description}),this.help_contents=o,this.help_contents.length&&(this.help_dialog=!0)},update_help_dialog(e){this.help_dialog=e},get_timezone(){return`${this.strings.ss_change_timezone} ${this.timezone}`}}}),document.querySelector("#downloadButtonMoodle").addEventListener("click",function(){console.log("click")})}}});
//# sourceMappingURL=logs.min.js.map

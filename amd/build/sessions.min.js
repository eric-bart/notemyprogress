define(["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/moment","local_fliplearning/pagination","local_fliplearning/chartstatic","local_fliplearning/pageheader","local_fliplearning/helpdialog"],function(e,s,t,i,o,n,r,a){"use strict";return{init:function(i){e.use(s),e.component("pagination",o),e.component("chart",n),e.component("pageheader",r),e.component("helpdialog",a);let l=new e({delimiters:["[[","]]"],el:"#work_sessions",vuetify:new s,data:()=>({strings:i.strings,groups:i.groups,userid:i.userid,courseid:i.courseid,timezone:i.timezone,render_has:i.profile_render,loading:!1,errors:[],pages:i.pages,hours_sessions:i.indicators.sessions,session_count:i.indicators.count,inverted_time:i.indicators.time,inverted_time_colors:i.inverted_time_colors,sessions_count_colors:i.sessions_count_colors,search:null,help_dialog:!1,help_contents:[]}),mounted(){document.querySelector("#sessions-loader").style.display="none",document.querySelector("#work_sessions").style.display="block"},methods:{get_help_content(){let e=[];return e.push({title:this.strings.section_help_title,description:this.strings.section_help_description}),e},update_interactions(e){this.loading=!0,this.errors=[];let s={action:"worksessions",userid:this.userid,courseid:this.courseid,weekcode:e.weekcode,profile:this.render_has};return t({method:"get",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",params:s}).then(e=>{200==e.status&&e.data.ok?(this.hours_sessions=e.data.data.indicators.sessions,this.session_count=e.data.data.indicators.count,this.inverted_time=e.data.data.indicators.time):this.error_messages.push(this.strings.error_network)}).catch(e=>{this.errors.push(this.strings.api_error_network)}).finally(()=>{this.loading=!1}),this.data},get_point_category_name(e,s){let t="y"===s;return e.series[t?"yAxis":"xAxis"].categories[e[t?"y":"x"]]},build_hours_sessions_chart(){let e=new Object;return e.title={text:null},e.chart={type:"heatmap",backgroundColor:null,style:{fontFamily:"poppins"}},e.xAxis={categories:this.strings.days},e.yAxis={categories:this.strings.hours,title:null,reversed:!0},e.colorAxis={min:0,minColor:"#E0E0E0",maxColor:"#118AB2"},e.legend={layout:"horizontal",verticalAlign:"bottom"},e.tooltip={formatter:function(){let e=l.get_point_category_name(this.point,"x"),s=l.get_point_category_name(this.point,"y"),t=l.strings.sessions_text;return 1==this.point.value&&(t=l.strings.session_text),"<b>"+e+" "+s+"</b>: "+this.point.value+" "+t}},e.series=[{borderWidth:2,borderColor:"#FAFAFA",data:this.hours_sessions}],e},build_inverted_time_chart(){let e=new Object;return e.chart={type:"bar",backgroundColor:null,style:{fontFamily:"poppins"}},e.title={text:null},e.colors=this.inverted_time_colors,e.xAxis={type:"category",crosshair:!0},e.yAxis={title:{text:this.strings.time_inverted_x_axis}},e.tooltip={shared:!0,useHTML:!0,formatter:function(){return`<b>${this.points[0].key}: </b>${l.convert_time(this.y)}`}},e.legend={enabled:!1},e.series=[{colorByPoint:!0,data:this.inverted_time.data}],e},build_sessions_count_chart(){let e=new Object;return e.chart={backgroundColor:null,style:{fontFamily:"poppins"}},e.title={text:null},e.colors=this.sessions_count_colors,e.yAxis={title:{text:this.strings.session_count_yaxis_title},allowDecimals:!1},e.xAxis={categories:this.session_count.categories},e.tooltip={valueSuffix:this.strings.session_count_tooltip_suffix},e.legend={layout:"horizontal",verticalAlign:"bottom"},e.series=this.session_count.data,e},convert_time(e){e*=3600;let s,t=this.strings.hours_short,i=this.strings.minutes_short,o=this.strings.seconds_short,n=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60);return s=n>=1?r>=1?`${n}${t} ${r}${i}`:`${n}${t}`:r>=1?a>=1?`${r}${i} ${a}${o}`:`${r}${i}`:`${a}${o}`},open_chart_help(e){let s=[];"inverted_time"==e?(s.push({title:this.strings.inverted_time_help_title,description:this.strings.inverted_time_help_description_p1}),s.push({description:this.strings.inverted_time_help_description_p2})):"hours_sessions"==e?(s.push({title:this.strings.hours_sessions_help_title,description:this.strings.hours_sessions_help_description_p1}),s.push({description:this.strings.hours_sessions_help_description_p2})):"sessions_count"==e&&(s.push({title:this.strings.sessions_count_help_title,description:this.strings.sessions_count_help_description_p1}),s.push({description:this.strings.sessions_count_help_description_p2})),this.help_contents=s,this.help_contents.length&&(this.help_dialog=!0)},update_help_dialog(e){this.help_dialog=e},get_timezone(){return`${this.strings.ss_change_timezone} ${this.timezone}`}}});function c(){let e=document.getElementsByClassName("highcharts-a11y-proxy-button");e[0].id="investedTime",e[1].id="sessionsPerHour",e[2].id="filterSessionsPerWeek",e[3].id="filterSessionsPerWeek",e[4].id="filterSessionsPerWeek",e[5].id="sessionsPerWeek";for(let s=0;s<e.length;s++)e[s].addEventListener("click",function(){let e=document.getElementsByClassName("highcharts-menu");for(s=0;s<e.length;s++)e[s].addEventListener("mouseenter",function(){this.id=this.parentElement.parentElement.id;let e=this.children;for(let s=0;s<e.length;s++)e[s].id=this.id,e[s].addEventListener("click",p)});"filterSessionsPerWeek"==this.id&&u("filtered","graphic","sessions_week","Filter that allows to see only certain information of the graph sessions by weeks")});let s=document.querySelectorAll(".highcharts-container");s[0].id="investedTime",s[1].id="sessionsPerHour",s[2].id="sessionsPerWeek",s.forEach(e=>{e.addEventListener("mouseenter",d)}),document.querySelectorAll(".pa-1.pr-4.pl-4.page.selected-page").forEach(e=>{e.addEventListener("click",function(){u("viewed",e.innerHTML,"week_section","Week section that allows you to obtain information on a specific week"),setTimeout(c,1e3)})});let t=document.getElementsByClassName("highcharts-series highcharts-series-0 highcharts-bar-series highcharts-tracker")[0].children;for(let e=0;e<t.length;e++)switch(t[e].className.baseVal){case"highcharts-point highcharts-color-0":t[e].id="averageTime";break;case"highcharts-point highcharts-color-1":t[e].id="totalTime"}document.querySelectorAll(".caption").forEach(e=>{e.addEventListener("click",h)})}function h(e){event.stopPropagation();var s="",t="",i="",o="";switch(this.id){case"helpSubmissions":s="viewed",i="help",t="submissions",o="Help section that provides information about the submissions graph";break;case"helpContentAccess":s="viewed",i="help",t="content_access",o="Help section that provides information about the content accessed graph"}u(s,t,i,o)}function d(e){event.stopPropagation();var s="",t="",i="",o="";switch(this.id){case"investedTime":s="viewed",t="invested_time",i="graphic",o="Bar graph that shows the average time invested by students as a function of the expected invested time";break;case"sessionsPerHour":s="viewed",t="sessions_hour",i="graphic",o="Graph showing the number of sessions performed according to the time of day";break;case"sessionsPerWeek":s="viewed",t="sessions_week",i="graphic",o="Graph showing the number of sessions performed per week";break;default:s="viewed",t="",i="graphic",o="A graphic"}u(s,t,i,o)}function p(e){this.removeEventListener("click",p);var s="",t="",i="",o="";switch(this.id){case"investedTime":s="downloaded",t="invested_time",i="graphic",o="Bar graph that shows the average time invested by students as a function of the expected invested time";break;case"sessionsPerHour":s="downloaded",t="sessions_hour",i="graphic",o="Graph showing the number of sessions performed according to the time of day";break;case"sessionsPerWeek":s="downloaded",t="sessions_week",i="graphic",o="Graph showing the number of sessions performed per week"}u(s,t,i,o)}function u(e,s,o,n){console.log("Action: "+e+", ObjectName: "+s+", ObjectType: "+o+", ObjectDescription: "+n);let r={courseid:i.courseid,userid:i.userid,action:"addLogs",sectionname:"TEACHER_STUDY_SESSIONS",actiontype:e,objectType:o,objectName:s,currentUrl:document.location.href,objectDescription:n};t({method:"get",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",params:r}).then(e=>{200==e.status&&e.data.ok?console.log("Information envoyée"):console.log("Information non envoyée")}).catch(e=>{console.log("Problème rencontré")})}setTimeout(function(){c()},1e3)}}});
//# sourceMappingURL=sessions.min.js.map
